<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags always come first-->
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />
        <!-- include bootstrap css-->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
        />
        <link rel="stylesheet" href="style/styles.css" />
        <title>News Crawling WebPage App</title>
        <script src="crawler/news_urls.js"></script>
        <script src="entire_news_list.js"></script>
        <script src="translater/translater.js"></script>
        <script>
            const axios = require("axios");
            const cheerio = require("cheerio");
        </script>
        <script src="crawler/get_news_src.js"></script>
        <script src="crawler/crawling_bbc_business.js"></script>
        <script src="crawler/crawling_bbc_sci.js"></script>
        <script src="crawler/crawling_bbc_tech.js"></script>
        <script src="crawler/crawling_bbc_world.js"></script>
        <script src="crawler/crawling_naver_business.js"></script>
        <script src="crawler/crawling_naver_tech.js"></script>
        <script src="crawler/crawling_naver_world.js"></script>
        <script src="crawler/crawling_wsj_business.js"></script>
        <script src="crawler/crawling_wsj_tech.js"></script>
        <script src="crawler/crawling_wsj_world.js"></script>
        <script>
            async function test_async(f1, f2, f3, f4, f5, f6, f7, f8, f9, f10) {
                return Promise.all([
                    f1(),
                    f2(),
                    f3(),
                    f4(),
                    f5(),
                    f6(),
                    f7(),
                    f8(),
                    f9(),
                    f10(),
                ]);
            }
            test_async(
                getNewsList_bb,
                getNewsList_bs,
                getNewsList_bt,
                getNewsList_bw,
                getNewsList_nb,
                getNewsList_nt,
                getNewsList_nw,
                getNewsList_wb,
                getNewsList_wt,
                getNewsList_ww
            ).then((x) => {
                x.forEach((elem, idx) => {
                    switch (idx) {
                        case 0:
                            entire_news_lists["bbc"]["business"].push(elem);
                            break;
                        case 1:
                            entire_news_lists["bbc"]["sci"] = elem;
                            break;
                        case 2:
                            entire_news_lists["bbc"]["tech"] = elem;
                            break;
                        case 3:
                            entire_news_lists["bbc"]["world"] = elem;
                            break;
                        case 4:
                            entire_news_lists["naver"]["business"] = elem;
                            break;
                        case 5:
                            entire_news_lists["naver"]["tech"] = elem;
                            break;
                        case 6:
                            entire_news_lists["naver"]["world"] = elem;
                            break;
                        case 7:
                            entire_news_lists["wsj"]["business"] = elem;
                            break;
                        case 8:
                            entire_news_lists["wsj"]["tech"] = elem;
                            break;
                        case 9:
                            entire_news_lists["wsj"]["world"] = elem;
                            break;
                        default:
                            console.log("wrong argument!");
                            break;
                    }
                });
                console.log(entire_news_lists);
            });
        </script>
    </head>
    <body style="background-color: rgb(237, 253, 224)">
        <div id="title">
            <h1 class="text-center">
                <i class="bi bi-newspaper"></i> News Crawling Lists
            </h1>
        </div>
        <div id="news_list"></div>
        <!-- script part -->

        <script>
            /* sample entire_news_list */
            let test_entire_news_lists = {
                bbc: {
                    tech: [
                        {
                            title: "bbc tech news1",
                            body: "bbc tech news1 body",
                            link: "",
                        },
                        {
                            title: "bbc tech news2",
                            body: "bbc tech news2 body",
                            link: "",
                        },
                    ],
                    sci: [
                        {
                            title: "bbc sci news1",
                            body: "bbc sci news1 body",
                            link: "",
                        },
                    ],
                    business: [
                        {
                            title: "bbc business news1",
                            body: "bbc business news1 body",
                            link: "",
                        },
                    ],
                    world: [
                        {
                            title: "bbc world news1",
                            body: "bbc world news1 body",
                            link: "",
                        },
                    ],
                },
                wsj: {
                    tech: [
                        {
                            title: "wsj tech news1",
                            body: "wsj tech news1 body",
                            link: "",
                        },
                        {
                            title: "wsj tech news2",
                            body: "wsj tech news2 body",
                            link: "",
                        },
                    ],
                    business: [
                        {
                            title: "wsj business news1",
                            body: "wsj business news1 body",
                            link: "",
                        },
                    ],
                    world: [
                        {
                            title: "wsj world news1",
                            body: "wsj world news1 body",
                            link: "",
                        },
                    ],
                },
                naver: {
                    tech: [
                        {
                            title: "naver tech news1",
                            body: "naver tech news1 body",
                            link: "",
                        },
                        {
                            title: "naver tech news2",
                            body: "naver tech news2 body",
                            link: "",
                        },
                    ],
                    business: [
                        {
                            title: "business tech news1",
                            body: "business tech news1 body",
                            link: "",
                        },
                    ],
                    world: [
                        {
                            title: "world tech news1",
                            body: "world tech news1 body",
                            link: "",
                        },
                    ],
                },
            };

            // test //
            let query = document.querySelector("#news_list");
            let checking_format = document.createElement("h6");
            checking_format.textContent = JSON.stringify(
                test_entire_news_lists
            );
            query.appendChild(checking_format);
            // test //

            function addNews(elem, portal) {
                for (let i = 0; i < elem.length; i++) {
                    let div = document.createElement("div");
                    div.className =
                        "bg-light p-1 rounded-2 ps-1 d-flex align-items-center border mt-2";

                    let img = document.createElement("img");
                    img.className = "image";
                    switch (portal) {
                        case 0:
                            img.src = "images/bbc_icon.png";
                            break;
                        case 1:
                            img.src = "images/naver_icon.png";
                            break;
                        case 2:
                            img.src = "images/wsj_icon.jpg";
                            break;
                    }

                    let span = document.createElement("span");
                    span.className = "me-auto fs-2";
                    span.appendChild(img);
                    span.innerHTML += elem[i].title;
                    div.appendChild(span);

                    function removeAllChild(parent) {
                        while (parent.firstChild) {
                            parent.removeChild(parent.firstChild);
                        }
                    }

                    /* buttontoSee */
                    let buttontoSee = document.createElement("button");
                    buttontoSee.className = "btn btn-sm btn-success me-1";
                    buttontoSee.innerHTML =
                        '<i class="bi bi-eye" style="font-size: large"></i>';
                    div.appendChild(buttontoSee);
                    buttontoSee.addEventListener("click", () => {
                        /* remove news_lists */
                        let list_div = document.querySelector("#news_list");
                        removeAllChild(list_div);
                        /* show news body */
                        let new_div = document.createElement("div");
                        let news_body = document.createElement("h4");
                        news_body.textContent = elem[i].body;

                        /* return button */
                        let buttonReturn = document.createElement("button");
                        buttonReturn.className = "btn btn-sm btn-danger";
                        buttonReturn.innerHTML =
                            '<i class="bi bi-eye-slash" style="font-size: large"></i>';
                        new_div.appendChild(buttonReturn);
                        buttonReturn.addEventListener("click", () => {
                            new_div.remove();
                            /* return to newslist */
                            loadNews();
                        });

                        new_div.appendChild(news_body);
                        list_div.appendChild(new_div);
                    });

                    /* buttonRemove */
                    let buttonRemove = document.createElement("button");
                    buttonRemove.className = "btn btn-sm btn-danger";
                    buttonRemove.innerHTML =
                        '<i class="bi bi-eye-slash" style="font-size: large"></i>';
                    div.appendChild(buttonRemove);
                    buttonRemove.addEventListener("click", () => {
                        div.remove();
                        /* remove news */
                    });

                    let newslist = document.querySelector("#news_list");
                    newslist.appendChild(div);
                }
            }

            function loadNews() {
                // entire news list handler

                /* bbc */
                addNews(test_entire_news_lists["bbc"]["business"], 0);
                addNews(test_entire_news_lists["bbc"]["sci"], 0);
                addNews(test_entire_news_lists["bbc"]["tech"], 0);
                addNews(test_entire_news_lists["bbc"]["world"], 0);
                /* naver */
                addNews(test_entire_news_lists["naver"]["business"], 1);
                addNews(test_entire_news_lists["naver"]["tech"], 1);
                addNews(test_entire_news_lists["naver"]["world"], 1);
                /* wsj */
                addNews(test_entire_news_lists["wsj"]["business"], 2);
                addNews(test_entire_news_lists["wsj"]["tech"], 2);
                addNews(test_entire_news_lists["wsj"]["world"], 2);
            }

            loadNews();
        </script>
    </body>
</html>
